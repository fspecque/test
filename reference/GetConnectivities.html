<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Derive connectivities from distances — GetConnectivities • SeuratIntegrate</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Derive connectivities from distances — GetConnectivities"><meta name="description" content="Adapted from scanpy's strategy in sc.pp.neighbors() to compute
connectivities. Two methods are available, using a Gaussian kernel or a fuzzy
union of simplical sets as implemented in umap-learn"><meta property="og:description" content="Adapted from scanpy's strategy in sc.pp.neighbors() to compute
connectivities. Two methods are available, using a Gaussian kernel or a fuzzy
union of simplical sets as implemented in umap-learn"><meta property="og:image" content="https://fspecque.github.io/test/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SeuratIntegrate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SeuratIntegrate.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Integration example: pbmcsca data</a></li>
    <li><a class="dropdown-item" href="../articles/setup_and_tips.html">Advice about conda and future</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Aide-mémoires"><span class="fa fa-sticky-note"></span></button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-"><li><a class="dropdown-item" href="../articles/memo_integration.html">Integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/memo_score.html">Scoring metrics</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cbib/Seurat-Integrate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Derive connectivities from distances</h1>
      <small class="dont-index">Source: <a href="https://github.com/cbib/Seurat-Integrate/blob/main/R/convert_distances.R" class="external-link"><code>R/convert_distances.R</code></a></small>
      <div class="d-none name"><code>GetConnectivities.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adapted from <span class="pkg">scanpy</span>'s strategy in <code>sc.pp.neighbors()</code> to compute
connectivities. Two methods are available, using a Gaussian kernel or a fuzzy
union of simplical sets as implemented in <span class="pkg">umap-learn</span></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GetConnectivities</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">neighbors.use</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"umap"</span>, <span class="st">"gauss"</span><span class="op">)</span>,</span>
<span>  graph.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  umap.set.op.mix.ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  umap.local.connectivity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  umap.niter.smoothing <span class="op">=</span> <span class="fl">64L</span>,</span>
<span>  umap.apply.set.operations <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  umap.bipartite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gauss.sigmas <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gauss.median.sigma <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a <code>Seurat</code> object</p></dd>


<dt id="arg-neighbors-use">neighbors.use<a class="anchor" aria-label="anchor" href="#arg-neighbors-use"></a></dt>
<dd><p>name of a <code>Neighbor</code> instance stored in the
<code>Seurat object</code> to derive connectivities from.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>one of "umap" or "gauss". Decides whether connectivities are
computed using  a fuzzy union of simplical sets ("umap") or a Gaussian kernel
("gauss")</p></dd>


<dt id="arg-graph-name">graph.name<a class="anchor" aria-label="anchor" href="#arg-graph-name"></a></dt>
<dd><p>name of the return <code>Graph</code> of connectivities to store
in the <code>Seurat object</code>.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>name of the assay to reference in the output <code>Graph</code> object.
Use the default assay of <code>object</code> if not provided.</p></dd>


<dt id="arg-umap-set-op-mix-ratio">umap.set.op.mix.ratio<a class="anchor" aria-label="anchor" href="#arg-umap-set-op-mix-ratio"></a></dt>
<dd><p>float between 0 and 1. Controls how the fuzzy
sets are mixed to obtain a global fuzzy simplicial set. 0 and 1 correspond to
a pure fuzzy intersection and union, respectively. Both fuzzy set operations
use the product t-norm. Only applies to the <strong>umap</strong> method.</p></dd>


<dt id="arg-umap-local-connectivity">umap.local.connectivity<a class="anchor" aria-label="anchor" href="#arg-umap-local-connectivity"></a></dt>
<dd><p>The local connectivity required, i.e. the
expected number of nearest neighbours locally connected. The higher, the more
local connections are output. In practice, this should be not more than the
local intrinsic dimension of the manifold. Only applies to the <strong>umap</strong>
method when <code>umap.apply.set.operations = TRUE</code>.</p></dd>


<dt id="arg-umap-niter-smoothing">umap.niter.smoothing<a class="anchor" aria-label="anchor" href="#arg-umap-niter-smoothing"></a></dt>
<dd><p>maximum number of iterations during the smoothing
process of distances. Only applies to the <strong>umap</strong> method.</p></dd>


<dt id="arg-umap-apply-set-operations">umap.apply.set.operations<a class="anchor" aria-label="anchor" href="#arg-umap-apply-set-operations"></a></dt>
<dd><p>set to <code>FALSE</code> to disable the fuzzy
union or intersection of the local fuzzy simplicial sets into a global fuzzy
simplicial set. Only applies to the <strong>umap</strong>
method.</p></dd>


<dt id="arg-umap-bipartite">umap.bipartite<a class="anchor" aria-label="anchor" href="#arg-umap-bipartite"></a></dt>
<dd><p>whether the knn network is bipartite (<code>FALSE</code> by
default). Only applies to the <strong>umap</strong> method.</p></dd>


<dt id="arg-gauss-sigmas">gauss.sigmas<a class="anchor" aria-label="anchor" href="#arg-gauss-sigmas"></a></dt>
<dd><p>by default, a sigma value (i.e. width of the kernel) per
cell is computed internally. Those sigmas are controlling for each cell's
connectivities range and magnitude. Alternatively, you can provide your own
width(s). If the length of <code>sigmas</code> is shorter than the number of cells,
it will be recycled. Only applies to the <strong>Gaussian</strong> method.</p></dd>


<dt id="arg-gauss-median-sigma">gauss.median.sigma<a class="anchor" aria-label="anchor" href="#arg-gauss-median-sigma"></a></dt>
<dd><p>which estimation method to use when
<code>sigmas = NULL</code>. By default, use the cell’s distance to its kth nearest
neighbour. When <code>median.sigma = TRUE</code>, use the median of distances to
the nearest neighbours (excluding self). Only applies to the
<strong>Gaussian</strong> method.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>whether to print progress messages</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>the Seurat object with a new <code>Graph</code> instance of name
<code>graph.name</code></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The UMAP method is a re-implementation of the function
<code>fuzzy_simplicial_set()</code> from <span class="pkg">umap-learn</span> and should estimate
identical connectivities. You can check the
<a href="https://umap-learn.readthedocs.io/en/latest/api.html#umap.umap_.fuzzy_simplicial_set" class="external-link">original documentation</a>.<br><br>
The Gaussian kernel method is a re-implementation of the analogous function
from <span class="pkg">scanpy</span> called by <code>sc.pp.neighbors()</code>. You can have a look at
the
<a href="https://github.com/scverse/scanpy/blob/b918a23eb77462837df90d7b3a30a573989d4d48/src/scanpy/neighbors/_connectivity.py#L18" class="external-link">original function</a><br><code>median.sigmas = FALSE</code> is the method used in Haghverdi L. et al.,2016.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>McInnes, L., Healy, J. &amp; Melville, J. UMAP: Uniform Manifold
Approximation and Projection for Dimension Reduction. arXiv preprint (2018).
<a href="https://doi.org/10.48550/ARXIV.1802.03426" class="external-link">DOI</a></p>
<p>Wolf, F. A., Angerer, P. &amp; Theis, F. J. SCANPY: large-scale
single-cell gene expression data analysis. Genome Biology 19, (2018).</p>
<p>Coifman, R. R., Lafon, S., Lee, A. B., Maggioni, M., Nadler, B.,
Warner, F. &amp; Zucker, S. W. Geometric diffusions as a tool for harmonic
analysis and structure definition of data: Diffusion maps. PNAS 102, 7426–7431
(2005). <a href="https://doi.org/10.1073/pnas.0500334102" class="external-link">DOI</a></p>
<p>Haghverdi, L., Büttner, M., Wolf, F. A., Buettner, F. &amp; Theis, F.
J. Diffusion pseudotime robustly reconstructs lineage branching. Nature
Methods 13, 845–848 (2016). <a href="https://doi.org/10.1038/nmeth.3971" class="external-link">DOI</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Florian Specque, Domitille Chalopin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

