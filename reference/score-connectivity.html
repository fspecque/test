<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Score a knn graph based on cell-type label connectivity — ScoreConnectivity • SeuratIntegrate</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Score a knn graph based on cell-type label connectivity — ScoreConnectivity"><meta name="description" content="Compute scores based on the connectivity between cells sharing the same label.
The score can be calculated in two fashions, either by quantifying the
connectivity of the largest subgraph for each cell label (identical to the
score used in Luecken M.D. et al., 2022), or directly on the whole
graph."><meta property="og:description" content="Compute scores based on the connectivity between cells sharing the same label.
The score can be calculated in two fashions, either by quantifying the
connectivity of the largest subgraph for each cell label (identical to the
score used in Luecken M.D. et al., 2022), or directly on the whole
graph."><meta property="og:image" content="https://fspecque.github.io/test/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SeuratIntegrate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SeuratIntegrate.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Integration example: pbmcsca data</a></li>
    <li><a class="dropdown-item" href="../articles/setup_and_tips.html">Advice about conda and future</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Aide-mémoires"><span class="fa fa-sticky-note"></span></button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-"><li><a class="dropdown-item" href="../articles/memo_integration.html">Integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/memo_score.html">Scoring metrics</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cbib/Seurat-Integrate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Score a knn graph based on cell-type label connectivity</h1>
      <small class="dont-index">Source: <a href="https://github.com/cbib/Seurat-Integrate/blob/main/R/metrics_connectivity.R" class="external-link"><code>R/metrics_connectivity.R</code></a></small>
      <div class="d-none name"><code>score-connectivity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute scores based on the connectivity between cells sharing the same label.
The score can be calculated in two fashions, either by quantifying the
connectivity of the largest subgraph for each cell label (identical to the
score used in Luecken M.D. <em>et al.</em>, 2022), or directly on the whole
graph.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ScoreConnectivity</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">graph.name</span>,</span>
<span>  <span class="va">cell.var</span>,</span>
<span>  do.symmetrize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  per.component <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  count.self <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weight.by.ncells <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">AddScoreConnectivity</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">integration</span>,</span>
<span>  <span class="va">graph.name</span>,</span>
<span>  <span class="va">cell.var</span>,</span>
<span>  do.symmetrize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  per.component <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  count.self <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weight.by.ncells <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A Seurat object</p></dd>


<dt id="arg-graph-name">graph.name<a class="anchor" aria-label="anchor" href="#arg-graph-name"></a></dt>
<dd><p>The name of the knn graph to score.</p></dd>


<dt id="arg-cell-var">cell.var<a class="anchor" aria-label="anchor" href="#arg-cell-var"></a></dt>
<dd><p>The name of the  cell variable (must be in the object metadata).</p></dd>


<dt id="arg-do-symmetrize">do.symmetrize<a class="anchor" aria-label="anchor" href="#arg-do-symmetrize"></a></dt>
<dd><p>whether to symmetrize the knn graph. Set to<code>FALSE</code>
to disable (not recommended, see <strong>Details</strong>)</p></dd>


<dt id="arg-per-component">per.component<a class="anchor" aria-label="anchor" href="#arg-per-component"></a></dt>
<dd><p>whether to use the same score as in Luecken M.D.
<em>et al.</em>, 2022. <code>TRUE</code> by default. See <strong>Details</strong>.</p></dd>


<dt id="arg-count-self">count.self<a class="anchor" aria-label="anchor" href="#arg-count-self"></a></dt>
<dd><p>whether to account for loops (i.e. cells connected to
themselves). <code>FALSE</code> by default</p></dd>


<dt id="arg-weight-by-ncells">weight.by.ncells<a class="anchor" aria-label="anchor" href="#arg-weight-by-ncells"></a></dt>
<dd><p>whether to weight the connectivity-derived scores
computed on each cell type label by their relative proportion in number of
cells. By default (<code>FALSE</code>), the overall score is computed as the mean
of scores computed per label. Ignored when <code>per.component = TRUE</code></p></dd>


<dt id="arg-integration">integration<a class="anchor" aria-label="anchor" href="#arg-integration"></a></dt>
<dd><p>name of the integration to score</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>ScoreConnectivity</code>: a single float between 0 and 1,
corresponding to the connectivity score.</p>
<p><code>AddScoreConnectivity</code>: the updated Seurat <code>object</code> with the Graph
connectivity score set for the integration.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The default parameters (<code>per.component = TRUE, count.self = FALSE</code>)
correspond to the original score from Luecken M.D. <em>et al.</em>, 2022. It is
computed as follow: for each cell type label \(c\) among the set of all
labels \(L\), the sub graph \(subG_c\) exclusively composed of cells
\(c\) is extracted from the full graph \(G\). Then, the size (i.e. the
number of cells, hence of vertices \(V\)) of the largest connected
component is divided by the size of \(subG_c\). Then, the mean of sub
graphs' scores is computed:
$$ratio_c = \frac{max(\left|V(CC(subG_c))\right|)}{\left|V(subG_c)\right|}$$
$$score = \frac{1}{\left| L \right|}\sum_{c \in L} ratio_c$$</p>

<p>When <code>per.component = FALSE</code>, the connectivity is computed on the full
graph \(G\). Let's consider the set of all labels \(L\),
\(c \in L\) and \(L\prime = L \setminus \{c\}\). Let's also denote the
edges between cells \(\in \{c\}\) \(E_c = E_{c \to c}(G)\)
and the edges connecting cells \(\in \{c\}\) with cells \(\in L\prime\)
\(E_c^{\prime} = E_{c \to L\prime}(G)\).
When <code>weight.by.ncells = TRUE</code>, the score is computed as follow:
$$score = \sum_{c \in L} \left( \frac{\left| V(subG_c) \right|}{\left| V(G) \right|} \times \frac{\left| E_c \right|}{\left| E_c^\prime \right| + \left| E_c \right|}\right)$$</p>
<p>When <code>weight.by.ncells = FALSE</code>, the score is the mean of ratio of edges:
$$score = \frac{1}{\left| L \right|}\sum_{c \in L} \frac{\left| E_c \right|}{\left| E_c^\prime \right| + \left| E_c \right|}$$</p>
<p>In either case, it is recommended to keep <code>do.symmetrize = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This score is an adaptation of the graph connectivity score as
described in Luecken M.D. <em>et al.</em>, 2022.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Luecken, M. D., Büttner, M., Chaichoompu, K., Danese, A.,
Interlandi, M., Mueller, M. F., Strobl, D. C., Zappia, L., Dugas, M.,
Colomé-Tatché, M. &amp; Theis, F. J. Benchmarking atlas-level data integration in
single-cell genomics. Nat Methods 19, 41–50 (2021).
<a href="https://doi.org/10.1038/s41592-021-01336-8" class="external-link">DOI</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Florian Specque, Domitille Chalopin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

