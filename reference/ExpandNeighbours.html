<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Expand knn graph to increase the number of neighbours — ExpandNeighbours • SeuratIntegrate</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Expand knn graph to increase the number of neighbours — ExpandNeighbours"><meta name="description" content="Expand a knn graph to increase the number of nearest neighbours using
Dijkstra's algorithm, or a diffusion algorithm. Dijkstra's algorithm is used
to prepare for LISI score, while diffusion is suited for preparing to compute
the kBET score. Beware that diffusion is designed to work on connectivity
matrices and is not adequate for distance-based networks."><meta property="og:description" content="Expand a knn graph to increase the number of nearest neighbours using
Dijkstra's algorithm, or a diffusion algorithm. Dijkstra's algorithm is used
to prepare for LISI score, while diffusion is suited for preparing to compute
the kBET score. Beware that diffusion is designed to work on connectivity
matrices and is not adequate for distance-based networks."><meta property="og:image" content="https://fspecque.github.io/test/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SeuratIntegrate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SeuratIntegrate.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Integration example: pbmcsca data</a></li>
    <li><a class="dropdown-item" href="../articles/setup_and_tips.html">Advice about conda and future</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Aide-mémoires"><span class="fa fa-sticky-note"></span></button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-"><li><a class="dropdown-item" href="../articles/memo_integration.html">Integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/memo_score.html">Scoring metrics</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cbib/Seurat-Integrate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Expand knn graph to increase the number of neighbours</h1>
      <small class="dont-index">Source: <a href="https://github.com/cbib/Seurat-Integrate/blob/main/R/expand_knn_graph.R" class="external-link"><code>R/expand_knn_graph.R</code></a></small>
      <div class="d-none name"><code>ExpandNeighbours.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Expand a knn graph to increase the number of nearest neighbours using
Dijkstra's algorithm, or a diffusion algorithm. Dijkstra's algorithm is used
to prepare for LISI score, while diffusion is suited for preparing to compute
the kBET score. Beware that diffusion is designed to work on connectivity
matrices and is not adequate for distance-based networks.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ExpandNeighbours</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  graph.name <span class="op">=</span> <span class="st">"RNA_nn"</span>,</span>
<span>  new.graph.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  graph.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"distances"</span>, <span class="st">"connectivities"</span><span class="op">)</span>,</span>
<span>  k.target <span class="op">=</span> <span class="fl">90L</span>,</span>
<span>  do.symmetrize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  algo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dijkstra"</span>, <span class="st">"diffusion"</span><span class="op">)</span>,</span>
<span>  which.dijkstra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"igraph"</span>, <span class="st">"fast"</span>, <span class="st">"slow"</span><span class="op">)</span>,</span>
<span>  dijkstra.ncores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  dijkstra.tol <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  diffusion.iter <span class="op">=</span> <span class="fl">26L</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Seurat'</span></span>
<span><span class="fu">ExpandNeighbours</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  graph.name <span class="op">=</span> <span class="st">"RNA_nn"</span>,</span>
<span>  new.graph.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  graph.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"distances"</span>, <span class="st">"connectivities"</span><span class="op">)</span>,</span>
<span>  k.target <span class="op">=</span> <span class="fl">90L</span>,</span>
<span>  do.symmetrize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  algo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dijkstra"</span>, <span class="st">"diffusion"</span><span class="op">)</span>,</span>
<span>  which.dijkstra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"igraph"</span>, <span class="st">"fast"</span>, <span class="st">"slow"</span><span class="op">)</span>,</span>
<span>  dijkstra.ncores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  dijkstra.tol <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  diffusion.iter <span class="op">=</span> <span class="fl">26L</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a <code>Seurat</code>, <code>Graph</code> or <code>Neighbor</code> object</p></dd>


<dt id="arg-graph-name">graph.name<a class="anchor" aria-label="anchor" href="#arg-graph-name"></a></dt>
<dd><p>name of a <code>Graph</code> or <code>Neighbor</code> instance stored in
the <code>Seurat object</code>.</p></dd>


<dt id="arg-new-graph-name">new.graph.name<a class="anchor" aria-label="anchor" href="#arg-new-graph-name"></a></dt>
<dd><p>name of the return <code>Graph</code> to store in the
<code>Seurat object</code>.</p></dd>


<dt id="arg-graph-type">graph.type<a class="anchor" aria-label="anchor" href="#arg-graph-type"></a></dt>
<dd><p>One of "distances" or "connectivities", indicating the type
of metric stored in the graph object.</p></dd>


<dt id="arg-k-target">k.target<a class="anchor" aria-label="anchor" href="#arg-k-target"></a></dt>
<dd><p>number of nearest neighbours to reach</p></dd>


<dt id="arg-do-symmetrize">do.symmetrize<a class="anchor" aria-label="anchor" href="#arg-do-symmetrize"></a></dt>
<dd><p>whether to make the input graph symmetric if necessary.
See <strong>Details</strong> section for further explanations</p></dd>


<dt id="arg-algo">algo<a class="anchor" aria-label="anchor" href="#arg-algo"></a></dt>
<dd><p>One of "dijkstra" or "diffusion". "diffusion" is suited for
connectivity matrices only</p></dd>


<dt id="arg-which-dijkstra">which.dijkstra<a class="anchor" aria-label="anchor" href="#arg-which-dijkstra"></a></dt>
<dd><p>one of "igraph", "fast" or "slow". "auto" (default)
chooses for you. See <strong>Details</strong> section</p></dd>


<dt id="arg-dijkstra-ncores">dijkstra.ncores<a class="anchor" aria-label="anchor" href="#arg-dijkstra-ncores"></a></dt>
<dd><p>number of cores to use for Dijkstra's algorithm.
Ignored when <code>which.dijkstra = "igraph"</code></p></dd>


<dt id="arg-dijkstra-tol">dijkstra.tol<a class="anchor" aria-label="anchor" href="#arg-dijkstra-tol"></a></dt>
<dd><p>number of sequential iterations with identical best
neighbours found to consider that Dijkstra's algorithm should be stopped.
Ignored when <code>which.dijkstra = "igraph"</code></p></dd>


<dt id="arg-diffusion-iter">diffusion.iter<a class="anchor" aria-label="anchor" href="#arg-diffusion-iter"></a></dt>
<dd><p>maximum number of iterations to reach <code>k.target</code></p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>name of the assay to store in the output <code>Graph</code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>whether to print progress messages</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>the Seurat object with a new <code>Graph</code> instance or a
<code>dgCMatrix</code> representing the <code>Graph</code> itself</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The approximate nature of the nearest neighbour search algorithm used to
compute the knn graph makes the resulting adjacency matrix asymmetric.
It means that \(cell_i\) can be a nearest neighbour of \(cell_j\) while
the reverse is not true even though the distance between \(cell_i\) and
\(cell_j\) is lower than the distance between \(cell_j\) and some of its
nearest neighbours.</p>
<p>One can choose to keep the graph as it is and consider it as a directed graph
(<code>do.symmetrize = FALSE</code>).
The alternative solution is to use all computed distances to extend the knn
graph by making the matrix symmetric. Note that connectivity graphs are
already symmetric, so the argument value should have no effect on the result.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Florian Specque, Domitille Chalopin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

