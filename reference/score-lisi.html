<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Score a dimensionality reduction embedding or knn graph using the Local Inverse Simpson Index — AddScoreLISI • SeuratIntegrate</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Score a dimensionality reduction embedding or knn graph using the Local Inverse Simpson Index — AddScoreLISI"><meta name="description" content="Compute the Local Inverse Simpson's Index (LISI) to estimate batch mixing or
cell type mixing (iLISI and cLISI respectively according to Luecken M.D.
et al., 2022).
AddScoreLISI returns an updated Seurat object, while ScoreLISI
outputs the raw LISI scores for each cell"><meta property="og:description" content="Compute the Local Inverse Simpson's Index (LISI) to estimate batch mixing or
cell type mixing (iLISI and cLISI respectively according to Luecken M.D.
et al., 2022).
AddScoreLISI returns an updated Seurat object, while ScoreLISI
outputs the raw LISI scores for each cell"><meta property="og:image" content="https://fspecque.github.io/test/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SeuratIntegrate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SeuratIntegrate.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Integration example: pbmcsca data</a></li>
    <li><a class="dropdown-item" href="../articles/setup_and_tips.html">Advice about conda and future</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Aide-mémoires"><span class="fa fa-sticky-note"></span></button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-"><li><a class="dropdown-item" href="../articles/memo_integration.html">Integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/memo_score.html">Scoring metrics</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cbib/Seurat-Integrate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Score a dimensionality reduction embedding or knn graph using the Local Inverse Simpson Index</h1>
      <small class="dont-index">Source: <a href="https://github.com/cbib/Seurat-Integrate/blob/main/R/metrics_lisi.R" class="external-link"><code>R/metrics_lisi.R</code></a></small>
      <div class="d-none name"><code>score-lisi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the Local Inverse Simpson's Index (LISI) to estimate batch mixing or
cell type mixing (iLISI and cLISI respectively according to Luecken M.D.
<em>et al.</em>, 2022).</p>
<p><code>AddScoreLISI</code> returns an updated Seurat object, while <code>ScoreLISI</code>
outputs the raw LISI scores for each cell</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AddScoreLISI</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">integration</span>,</span>
<span>  batch.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">reduction</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">graph.name</span>,</span>
<span>  graph.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"distances"</span>, <span class="st">"connectivities"</span><span class="op">)</span>,</span>
<span>  do.symmetrize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save.graph <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  new.graph <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  perplexity <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  do.scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  largest.component.only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ScoreLISI</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  batch.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">reduction</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">graph.name</span>,</span>
<span>  graph.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"distances"</span>, <span class="st">"connectivities"</span><span class="op">)</span>,</span>
<span>  do.symmetrize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return.graph <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  perplexity <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  largest.component.only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A Seurat object</p></dd>


<dt id="arg-integration">integration<a class="anchor" aria-label="anchor" href="#arg-integration"></a></dt>
<dd><p>name of the integration to score</p></dd>


<dt id="arg-batch-var">batch.var<a class="anchor" aria-label="anchor" href="#arg-batch-var"></a></dt>
<dd><p>The name of the batch variable (must be in the object metadata).
Can be omitted if <code>cell.var</code> is not <code>NULL</code></p></dd>


<dt id="arg-cell-var">cell.var<a class="anchor" aria-label="anchor" href="#arg-cell-var"></a></dt>
<dd><p>The name of the  cell variable (must be in the object metadata).
Can be omitted if <code>batch.var</code> is not <code>NULL</code></p></dd>


<dt id="arg-reduction">reduction<a class="anchor" aria-label="anchor" href="#arg-reduction"></a></dt>
<dd><p>The name of the reduction to score. Arguments
<code>reduction</code> and <code>graph.name</code> are mutually exclusive</p></dd>


<dt id="arg-dims">dims<a class="anchor" aria-label="anchor" href="#arg-dims"></a></dt>
<dd><p>The dimensions of <code>reduction</code> to consider. All dimensions are
used by default. Ignored when scoring a graph</p></dd>


<dt id="arg-graph-name">graph.name<a class="anchor" aria-label="anchor" href="#arg-graph-name"></a></dt>
<dd><p>The name of the knn graph to score. Arguments
<code>reduction</code> and <code>graph.name</code> are mutually exclusive</p></dd>


<dt id="arg-graph-type">graph.type<a class="anchor" aria-label="anchor" href="#arg-graph-type"></a></dt>
<dd><p>one of 'distances' or 'connectivities' (not supported yet).
Ignored when scoring a cell embedding</p></dd>


<dt id="arg-do-symmetrize">do.symmetrize<a class="anchor" aria-label="anchor" href="#arg-do-symmetrize"></a></dt>
<dd><p>whether to symmetrize the knn graphs. Set to<code>FALSE</code>
to disable (not recommended, especially when scoring a knn graph directly.
See <strong>Details</strong>)</p></dd>


<dt id="arg-save-graph">save.graph<a class="anchor" aria-label="anchor" href="#arg-save-graph"></a></dt>
<dd><p>whether to save the graph used to compute the LISI score(s)
in the Seurat object</p></dd>


<dt id="arg-new-graph">new.graph<a class="anchor" aria-label="anchor" href="#arg-new-graph"></a></dt>
<dd><p>name of the graph used to compute the LISI score(s).
When <code>new.graph = NULL</code> (default), a name is constructed depending on
input and arguments. Ignored when <code>save.graph = FALSE</code></p></dd>


<dt id="arg-perplexity">perplexity<a class="anchor" aria-label="anchor" href="#arg-perplexity"></a></dt>
<dd><p>third of number of each cell's neighbours. When the value of
perplexity and the number of neighbours (*3) are discrepant, the graph is
adapted. Multiple scores with varying values of perplexity are not comparable,
hence it is recommended to use the same value for each integration to score.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Stop the computation of the local Simpson's index when it converges
to this tolerance.</p></dd>


<dt id="arg-do-scale">do.scale<a class="anchor" aria-label="anchor" href="#arg-do-scale"></a></dt>
<dd><p>whether to scale the output LISI values between 0 and 1.</p></dd>


<dt id="arg-largest-component-only">largest.component.only<a class="anchor" aria-label="anchor" href="#arg-largest-component-only"></a></dt>
<dd><p>whether to compute the scores on the largest
component or all sufficiently large components (default)</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>the name of the assay to reference in the output Graph object (
when <code>save.graph = TRUE</code>)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>whether to print progress messages</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters to pass to other methods
(see <strong>Details</strong>).</p></dd>


<dt id="arg-return-graph">return.graph<a class="anchor" aria-label="anchor" href="#arg-return-graph"></a></dt>
<dd><p>whether to return the graph used to compute the LISI score(s)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>ScoreLISI</code>: a data frame with each cell's raw LISI score, or
a list containing the aforementioned data frame and the graph used to compute
it (<code>return.graph = TRUE</code>).</p>
<p><code>AddScoreLISI</code>: the updated Seurat <code>object</code>, with cell-wise LISI
scores in the meta data (identical to <code>ScoreLISI</code>'s output), global
scores in misc and a new Graph object when <code>save.graph = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When scoring a reduction, a knn graph with enough neighbours per cell is
computed. If <code>do.symmetrize = TRUE</code>, the graph is symmetrized and the k
best neighbours are kept.</p>
<p>When scoring a knn graph, the graph is expanded with Dijkstra's algorithm to
reach enough neighbours per cell. If <code>do.symmetrize = TRUE</code>, the graph
is symmetrized beforehand. Note that when <code>do.symmetrize = FALSE</code>,
Dijkstra's algorithm is applied on the asymmetric distance matrix, and
components are computed. But each component is then symmetrized and Dijkstra's
algorithm is computed on each of them. Indeed, there is no guarantee that the
cells' number of neighbours is preserved after decomposing the directed graph.
Hence, when <code>do.symmetrize = FALSE</code> and a graph is input, the graph is
considered as directed only to find components.</p>
<p>In either case, it is recommended to keep <code>do.symmetrize = TRUE</code>.</p>
<p>For possible additional parameters, see <code><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></code>
(when inputting a reduction) or <code><a href="ExpandNeighbours.html">ExpandNeighbours</a></code> (when
inputting a knn graph)</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This score is an adaptation of the LISI score as described in Korsunsky
I. <em>et al.</em>, 2019 and also used in Luecken M.D. <em>et al.</em>, 2022.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Korsunsky, I., Millard, N., Fan, J., Slowikowski, K., Zhang, F.,
Wei, K., Baglaenko, Y., Brenner, M., Loh, P. &amp; Raychaudhuri, S. Fast,
sensitive and accurate integration of single-cell data with Harmony. Nat
Methods 16, 1289–1296 (2019).
<a href="https://doi.org/10.1038/s41592-019-0619-0" class="external-link">DOI</a></p>
<p>Luecken, M. D., Büttner, M., Chaichoompu, K., Danese, A.,
Interlandi, M., Mueller, M. F., Strobl, D. C., Zappia, L., Dugas, M.,
Colomé-Tatché, M. &amp; Theis, F. J. Benchmarking atlas-level data integration in
single-cell genomics. Nat Methods 19, 41–50 (2021).
<a href="https://doi.org/10.1038/s41592-021-01336-8" class="external-link">DOI</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></code>, <code><a href="ExpandNeighbours.html">ExpandNeighbours</a></code>
and <code><a href="CutKnn.html">CutKnn</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Florian Specque, Domitille Chalopin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

